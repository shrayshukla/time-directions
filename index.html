<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>â° Time & Directions Adventure!</title>
<link href="https://fonts.googleapis.com/css2?family=Baloo+2:wght@400;600;700;800;900&family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">
<style>
:root{--purple:#9C6FDE;--pink:#FF7EB3;--orange:#FF8C42;--green:#66BB6A;--sky:#4FC3F7;--sun:#FFD600;--card:#ffffffee;--shadow:0 8px 32px rgba(80,60,140,.15);--r:24px;}
*{box-sizing:border-box;margin:0;padding:0;}
body{font-family:"Nunito",sans-serif;background:linear-gradient(160deg,#e0f7fa 0%,#e8f5e9 50%,#fff9c4 100%);min-height:100vh;overflow-x:hidden;}
.particle{position:fixed;pointer-events:none;z-index:0;font-size:1.2rem;animation:floatUp linear infinite;opacity:.4;}
@keyframes floatUp{0%{transform:translateY(105vh) rotate(0deg);opacity:0}10%{opacity:.5}90%{opacity:.5}100%{transform:translateY(-10vh) rotate(360deg);opacity:0}}
header{text-align:center;padding:24px 20px 10px;position:relative;z-index:2;}
header h1{font-family:"Baloo 2",cursive;font-size:clamp(1.8rem,5vw,3rem);font-weight:900;background:linear-gradient(90deg,#FF7043,#FF7EB3,#9C6FDE,#4FC3F7,#66BB6A);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;animation:titleBounce .8s cubic-bezier(.36,1.56,.64,1) both;}
@keyframes titleBounce{from{transform:scale(.4);opacity:0}to{transform:scale(1);opacity:1}}
.mascot{font-size:2.8rem;animation:wave 2s ease-in-out infinite;display:inline-block;cursor:pointer;}
@keyframes wave{0%,100%{transform:rotate(-10deg) scale(1)}50%{transform:rotate(15deg) scale(1.15)}}
.starbar{display:inline-flex;align-items:center;gap:8px;background:linear-gradient(90deg,#fff9c4,#ffe082,#fff9c4);border-radius:50px;padding:8px 22px;border:2.5px solid #FFD600;box-shadow:0 4px 14px rgba(255,180,0,.25);font-weight:800;color:#7b3f00;font-size:1rem;margin:6px auto 14px;cursor:pointer;transition:transform .15s;}
.starbar:hover{transform:scale(1.05);}
.star-num{font-size:1.4rem;font-weight:900;transition:transform .3s cubic-bezier(.36,1.56,.64,1);display:inline-block;}
.star-num.pop{transform:scale(1.7);}
nav{display:flex;flex-wrap:wrap;justify-content:center;gap:10px;padding:0 12px 16px;position:relative;z-index:2;}
nav button{font-family:"Baloo 2",cursive;font-size:.92rem;font-weight:700;border:none;border-radius:50px;padding:9px 18px;cursor:pointer;transition:all .2s cubic-bezier(.36,1.56,.64,1);box-shadow:0 4px 0 rgba(0,0,0,.18);position:relative;top:0;}
nav button:hover{transform:translateY(-3px) scale(1.07);box-shadow:0 7px 0 rgba(0,0,0,.14);}
nav button:active{top:3px;box-shadow:0 0px 0 rgba(0,0,0,.14);}
nav button.active{box-shadow:0 0 0 3px white,0 0 0 6px var(--purple);transform:scale(1.08);}
.nb1{background:linear-gradient(135deg,#FF7EB3,#FF4081);color:#fff}
.nb2{background:linear-gradient(135deg,#FFD600,#FF8C42);color:#fff}
.nb3{background:linear-gradient(135deg,#66BB6A,#26A69A);color:#fff}
.nb4{background:linear-gradient(135deg,#4FC3F7,#7E57C2);color:#fff}
.nb5{background:linear-gradient(135deg,#9C6FDE,#E040FB);color:#fff}
.nb6{background:linear-gradient(135deg,#FF8C42,#FF5722);color:#fff}
.panel{display:none;max-width:920px;margin:0 auto;padding:0 12px 50px;position:relative;z-index:2;animation:pIn .4s cubic-bezier(.36,1.56,.64,1) both;}
.panel.active{display:block;}
@keyframes pIn{from{transform:translateY(28px) scale(.97);opacity:0}to{transform:none;opacity:1}}
.card{background:var(--card);border-radius:var(--r);padding:22px;margin-bottom:16px;box-shadow:var(--shadow);border:2px solid rgba(255,255,255,.85);}
.card h2{font-family:"Baloo 2",cursive;font-size:1.45rem;font-weight:800;color:#5c35a0;margin-bottom:10px;display:flex;align-items:center;gap:8px;}
/* SKY */
.sky-scene{border-radius:20px;overflow:hidden;position:relative;height:190px;background:linear-gradient(180deg,#FFE082 0%,#87CEEB 40%,#87CEEB 75%,#5DBB63 75%,#4CAF50 100%);cursor:crosshair;margin-bottom:14px;transition:background 1s;user-select:none;touch-action:none;}
.cloud{position:absolute;animation:cloudDrift linear infinite;pointer-events:none;}
@keyframes cloudDrift{0%{transform:translateX(-80px)}100%{transform:translateX(110vw)}}
.drag-sun{position:absolute;font-size:3rem;cursor:grab;filter:drop-shadow(0 4px 12px rgba(255,180,0,.5));z-index:5;transition:filter .3s;touch-action:none;}
.drag-sun:active{cursor:grabbing;}
.sky-label{position:absolute;top:8px;left:50%;transform:translateX(-50%);font-family:"Baloo 2",cursive;font-weight:800;font-size:1.2rem;color:#fff;text-shadow:0 2px 8px rgba(0,0,0,.4);background:rgba(0,0,0,.18);border-radius:50px;padding:3px 14px;pointer-events:none;}
.drag-hint{position:absolute;bottom:8px;right:10px;font-size:.72rem;background:rgba(255,255,255,.75);border-radius:10px;padding:3px 9px;font-weight:700;color:#5c35a0;pointer-events:none;}
/* TOD */
.tod-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(120px,1fr));gap:11px;margin-top:11px;}
.tod-card{border-radius:18px;padding:14px 10px;text-align:center;cursor:pointer;transition:transform .2s cubic-bezier(.36,1.56,.64,1),box-shadow .2s;font-weight:700;font-size:.85rem;position:relative;overflow:hidden;}
.tod-card:hover{transform:scale(1.09) rotate(-2deg);box-shadow:0 10px 28px rgba(0,0,0,.15);}
.tod-card:active{transform:scale(.96);}
.tod-card .ti{font-size:2rem;margin-bottom:5px;display:block;transition:transform .3s;}
.tod-card:hover .ti{transform:scale(1.3) rotate(10deg);}
.tod-morning{background:linear-gradient(160deg,#fff9c4,#FFE082);color:#7b3f00;}
.tod-noon{background:linear-gradient(160deg,#B3E5FC,#4FC3F7);color:#01579b;}
.tod-afternoon{background:linear-gradient(160deg,#FFCCBC,#FF8A65);color:#bf360c;}
.tod-evening{background:linear-gradient(160deg,#CE93D8,#7B1FA2);color:#fff;}
.tod-night{background:linear-gradient(160deg,#3949AB,#1a1a4e);color:#90CAF9;}
.ripple{position:absolute;border-radius:50%;background:rgba(255,255,255,.4);transform:scale(0);animation:rAnim .6s linear;pointer-events:none;}
@keyframes rAnim{to{transform:scale(4);opacity:0}}
/* UNITS */
.unit-chain{display:flex;flex-wrap:wrap;gap:0;align-items:center;margin:14px 0;}
.unit-block{background:linear-gradient(135deg,#f3e8ff,#e8d8ff);border:2.5px solid #9C6FDE;border-radius:14px;padding:9px 14px;font-weight:800;font-size:.85rem;color:#5c35a0;cursor:pointer;transition:all .2s cubic-bezier(.36,1.56,.64,1);}
.unit-block:hover{transform:scale(1.12);background:linear-gradient(135deg,#9C6FDE,#E040FB);color:#fff;box-shadow:0 4px 16px rgba(156,111,222,.4);}
.unit-block.active-unit{background:linear-gradient(135deg,#9C6FDE,#E040FB);color:#fff;}
.unit-arrow{font-size:1.3rem;color:#9C6FDE;padding:0 5px;}
/* AMPM FLIP */
.ampm-wrap{display:grid;grid-template-columns:1fr 1fr;gap:13px;margin-top:13px;}
.ampm-flip{perspective:600px;cursor:pointer;height:130px;}
.ampm-inner{position:relative;width:100%;height:100%;transform-style:preserve-3d;transition:transform .6s cubic-bezier(.36,1.56,.64,1);}
.ampm-flip.flipped .ampm-inner{transform:rotateY(180deg);}
.af,.ab{position:absolute;inset:0;border-radius:18px;backface-visibility:hidden;display:flex;flex-direction:column;align-items:center;justify-content:center;font-weight:700;}
.ab{transform:rotateY(180deg);}
.af.am{background:linear-gradient(135deg,#fff9c4,#FFE082);color:#7b3f00;}
.ab.am2{background:linear-gradient(135deg,#FFD600,#FF8C42);color:#fff;}
.af.pm{background:linear-gradient(135deg,#E1BEE7,#AB47BC);color:#fff;}
.ab.pm2{background:linear-gradient(135deg,#7B1FA2,#4A148C);color:#fff;}
.abig{font-family:"Baloo 2",cursive;font-size:2rem;font-weight:900;}
/* CLOCK */
.clock-svg-wrap{position:relative;width:230px;height:230px;cursor:grab;touch-action:none;}
.clock-time-display{font-family:"Baloo 2",cursive;font-size:2.5rem;font-weight:800;color:#5c35a0;}
.clock-controls{display:flex;gap:9px;flex-wrap:wrap;justify-content:center;}
.cbtn{background:linear-gradient(135deg,#9C6FDE,#E040FB);color:#fff;border:none;border-radius:50px;padding:8px 16px;font-family:"Baloo 2",cursive;font-weight:700;font-size:.9rem;cursor:pointer;transition:transform .15s,box-shadow .15s;box-shadow:0 4px 12px rgba(156,111,222,.3);}
.cbtn:hover{transform:scale(1.1);box-shadow:0 6px 20px rgba(156,111,222,.4);}
.cbtn:active{transform:scale(.95);}
.spin-hint{font-size:.82rem;color:#9C6FDE;font-weight:700;margin:3px 0 8px;animation:pulse 2s ease-in-out infinite;}
@keyframes pulse{0%,100%{opacity:.7}50%{opacity:1}}
/* SET TIME */
.set-time-card{background:linear-gradient(135deg,#f3e8ff,#e8f5e9);border-radius:18px;padding:18px;margin-top:12px;text-align:center;}
.target-t{font-family:"Baloo 2",cursive;font-size:1.9rem;font-weight:900;color:#5c35a0;margin:8px 0;}
/* CALENDAR */
.cal-grid{display:grid;grid-template-columns:repeat(7,1fr);gap:4px;margin-bottom:12px;}
.cal-h{font-weight:800;font-size:.78rem;text-align:center;padding:6px 3px;border-radius:9px;color:#fff;background:linear-gradient(135deg,#9C6FDE,#E040FB);}
.cal-day{background:rgba(255,255,255,.8);border-radius:9px;padding:6px 3px;text-align:center;font-size:.88rem;font-weight:700;color:#333;cursor:pointer;transition:all .2s cubic-bezier(.36,1.56,.64,1);border:2px solid transparent;min-height:38px;display:flex;align-items:center;justify-content:center;}
.cal-day:hover:not(.empty){transform:scale(1.2) rotate(-2deg);border-color:#9C6FDE;background:#f3e8ff;z-index:2;position:relative;}
.cal-day.today{background:linear-gradient(135deg,#FFD600,#FF8C42);color:#fff;border-color:#FF8C42;animation:todayPulse 2s ease-in-out infinite;}
@keyframes todayPulse{0%,100%{box-shadow:0 0 0 0 rgba(255,180,0,.5)}50%{box-shadow:0 0 0 6px rgba(255,180,0,0)}}
.cal-day.empty{background:transparent;cursor:default;}
.cal-day.visited{background:linear-gradient(135deg,#C8E6C9,#66BB6A);color:#1b5e20;border-color:#66BB6A;}
/* DAYS DRAG */
.drag-match{display:flex;gap:18px;flex-wrap:wrap;margin-top:12px;}
.drag-src,.drag-tgt{display:flex;flex-direction:column;gap:7px;flex:1;min-width:130px;}
.draggable-day{background:linear-gradient(135deg,#FF7EB3,#FF4081);color:#fff;border-radius:50px;padding:7px 16px;font-weight:800;font-size:.88rem;cursor:grab;transition:transform .15s,opacity .15s;user-select:none;text-align:center;}
.draggable-day:active{cursor:grabbing;opacity:.6;transform:scale(1.08);}
.drop-tgt{background:rgba(255,255,255,.6);border:2.5px dashed #9C6FDE;border-radius:50px;padding:7px 16px;font-weight:800;font-size:.88rem;color:#bbb;transition:all .2s;text-align:center;min-height:38px;}
.drop-tgt.over{background:#f3e8ff;border-color:#E040FB;transform:scale(1.04);}
.drop-tgt.correct{background:linear-gradient(135deg,#C8E6C9,#66BB6A);color:#1b5e20;border-color:#66BB6A;border-style:solid;}
.drop-tgt.wrong{background:linear-gradient(135deg,#FFCDD2,#FF5252);color:#b71c1c;border-color:#b71c1c;border-style:solid;animation:shake .3s;}
@keyframes shake{0%,100%{transform:translateX(0)}25%{transform:translateX(-6px)}75%{transform:translateX(6px)}}
/* MONTHS */
.months-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(90px,1fr));gap:8px;}
.month-chip{border-radius:13px;padding:9px 5px;text-align:center;font-weight:700;font-size:.8rem;cursor:pointer;transition:transform .2s cubic-bezier(.36,1.56,.64,1);box-shadow:0 3px 10px rgba(0,0,0,.1);color:#fff;position:relative;}
.month-chip:hover{transform:scale(1.13) rotate(-2deg);}
.month-chip:active{transform:scale(.96);}
.month-chip.picked::after{content:"âœ“";position:absolute;top:3px;right:5px;font-size:.78rem;font-weight:900;}
/* POEM */
.poem-line{cursor:pointer;padding:3px 7px;border-radius:8px;transition:all .2s;font-style:italic;font-size:.96rem;font-weight:700;color:#4a2080;line-height:1.9;}
.poem-line:hover{background:rgba(156,111,222,.15);transform:translateX(8px);font-style:normal;}
.poem-line.lit{background:rgba(156,111,222,.3);font-weight:900;font-style:normal;}
/* COMPASS */
.compass-outer{width:210px;height:210px;border-radius:50%;background:conic-gradient(from 0deg,#FFE082 0deg,#FF7043 90deg,#CE93D8 180deg,#90CAF9 270deg,#FFE082 360deg);padding:13px;box-shadow:0 8px 32px rgba(0,0,0,.15);cursor:grab;user-select:none;touch-action:none;}
.compass-outer:active{cursor:grabbing;}
.compass-inner{width:100%;height:100%;border-radius:50%;background:radial-gradient(circle at 35% 35%,#fff 0%,#f3e8ff 100%);display:flex;align-items:center;justify-content:center;position:relative;}
.clabel{position:absolute;font-family:"Baloo 2",cursive;font-weight:900;font-size:1.25rem;cursor:pointer;transition:transform .2s cubic-bezier(.36,1.56,.64,1);}
.clabel:hover{transform:scale(1.35);}
.cn{top:7px;left:50%;transform:translateX(-50%);color:#0288D1;}
.cs{bottom:7px;left:50%;transform:translateX(-50%);color:#E64A19;}
.ce{right:7px;top:50%;transform:translateY(-50%);color:#388E3C;}
.cw{left:7px;top:50%;transform:translateY(-50%);color:#7B1FA2;}
.dir-cards{display:grid;grid-template-columns:1fr 1fr;gap:11px;}
.dir-card{border-radius:18px;padding:15px;cursor:pointer;transition:transform .2s cubic-bezier(.36,1.56,.64,1),box-shadow .2s;position:relative;overflow:hidden;}
.dir-card:hover{transform:scale(1.05) rotate(-1deg);box-shadow:0 10px 28px rgba(0,0,0,.15);}
.dir-card:active{transform:scale(.97);}
.dir-n{background:linear-gradient(135deg,#B3E5FC,#0288D1);color:#fff;}
.dir-s{background:linear-gradient(135deg,#FFCCBC,#E64A19);color:#fff;}
.dir-e{background:linear-gradient(135deg,#C8E6C9,#388E3C);color:#fff;}
.dir-w{background:linear-gradient(135deg,#E1BEE7,#7B1FA2);color:#fff;}
.dir-letter{font-family:"Baloo 2",cursive;font-size:2.6rem;font-weight:900;opacity:.2;position:absolute;top:2px;right:8px;}
/* POSITION WORDS */
.pos-scene{background:linear-gradient(180deg,#87CEEB 0%,#87CEEB 65%,#5DBB63 65%,#4CAF50 100%);border-radius:18px;padding:16px;position:relative;min-height:170px;margin:12px 0;}
.pos-object{position:absolute;font-size:1.9rem;transition:all .4s cubic-bezier(.36,1.56,.64,1);}
.pos-word-btns{display:flex;flex-wrap:wrap;gap:7px;margin-top:9px;}
.pos-btn{background:rgba(255,255,255,.88);border:2.5px solid #9C6FDE;border-radius:50px;padding:5px 12px;font-weight:800;font-size:.82rem;color:#5c35a0;cursor:pointer;transition:all .2s cubic-bezier(.36,1.56,.64,1);}
.pos-btn:hover{background:#9C6FDE;color:#fff;transform:scale(1.12);}
.pos-btn:active{transform:scale(.94);}
/* MAZE */
.maze-wrap{border-radius:18px;overflow:hidden;position:relative;border:3px solid #9C6FDE;background:#f5f5f5;}
.maze-canvas{display:block;width:100%;max-width:400px;margin:0 auto;}
.maze-controls{display:flex;gap:9px;justify-content:center;margin-top:11px;flex-wrap:wrap;}
.mbtn{background:linear-gradient(135deg,#4FC3F7,#7E57C2);color:#fff;border:none;border-radius:50px;padding:10px 18px;font-family:"Baloo 2",cursive;font-weight:700;font-size:1rem;cursor:pointer;transition:transform .15s;box-shadow:0 4px 12px rgba(126,87,194,.3);}
.mbtn:hover{transform:scale(1.12);}
.mbtn:active{transform:scale(.94);}
/* QUIZ */
.quiz-progress{display:flex;gap:5px;margin-bottom:14px;flex-wrap:wrap;}
.q-dot{width:15px;height:15px;border-radius:50%;background:#e0e0e0;transition:all .3s;}
.q-dot.done{background:linear-gradient(135deg,#66BB6A,#26A69A);}
.q-dot.wrong2{background:linear-gradient(135deg,#FF5252,#FF1744);}
.q-dot.curr{background:linear-gradient(135deg,#FFD600,#FF8C42);transform:scale(1.35);}
.quiz-q{font-family:"Baloo 2",cursive;font-size:1.25rem;font-weight:700;color:#4a2080;margin-bottom:16px;line-height:1.4;}
.quiz-opts{display:grid;grid-template-columns:1fr 1fr;gap:9px;}
.qopt{background:rgba(255,255,255,.92);border:2.5px solid #e0d0f8;border-radius:15px;padding:12px 13px;font-size:.95rem;font-weight:700;color:#444;cursor:pointer;transition:all .2s cubic-bezier(.36,1.56,.64,1);text-align:left;font-family:"Nunito",sans-serif;position:relative;overflow:hidden;}
.qopt:hover{transform:scale(1.05) rotate(-.5deg);border-color:#9C6FDE;background:#f3e8ff;}
.qopt:active{transform:scale(.97);}
.qopt.correct{background:linear-gradient(135deg,#C8E6C9,#66BB6A);border-color:#388E3C;color:#1b5e20;animation:cBounce .4s cubic-bezier(.36,1.56,.64,1);}
@keyframes cBounce{0%{transform:scale(.9)}60%{transform:scale(1.08)}100%{transform:scale(1)}}
.qopt.wrong{background:linear-gradient(135deg,#FFCDD2,#FF5252);border-color:#b71c1c;color:#b71c1c;animation:shake .3s;}
.quiz-fb{text-align:center;font-family:"Baloo 2",cursive;font-size:1.35rem;font-weight:800;min-height:45px;margin-top:12px;animation:popIn .4s cubic-bezier(.36,1.56,.64,1) both;}
@keyframes popIn{from{transform:scale(.5) rotate(-10deg);opacity:0}to{transform:none;opacity:1}}
.fb-ok{color:#2e7d32;}.fb-bad{color:#c62828;}
.next-btn{display:block;margin:12px auto 0;background:linear-gradient(135deg,#9C6FDE,#E040FB);color:#fff;border:none;border-radius:50px;padding:10px 32px;font-family:"Baloo 2",cursive;font-weight:700;font-size:1rem;cursor:pointer;transition:transform .2s;box-shadow:0 4px 0 rgba(0,0,0,.15);}
.next-btn:hover{transform:scale(1.07);}
/* BADGES */
.badges-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(115px,1fr));gap:12px;}
.badge{background:var(--card);border-radius:17px;padding:14px 9px;text-align:center;box-shadow:var(--shadow);transition:transform .2s cubic-bezier(.36,1.56,.64,1);border:2px solid rgba(255,255,255,.85);cursor:pointer;position:relative;}
.badge:hover{transform:scale(1.08) rotate(-1.5deg);}
.badge.locked{filter:grayscale(.8);opacity:.5;}
.badge .bi{font-size:2.4rem;margin-bottom:5px;transition:transform .3s;display:block;}
.badge:hover .bi{transform:scale(1.25) rotate(10deg);}
.badge .bn{font-weight:800;font-size:.8rem;color:#5c35a0;}
.badge .bd{font-size:.68rem;color:#888;margin-top:2px;}
.badge .lk{position:absolute;top:5px;right:7px;font-size:.95rem;}
/* MISC */
.fact-box{background:linear-gradient(135deg,#fff9c4,#FFE082);border-radius:13px;padding:11px 15px;margin-top:9px;font-weight:700;color:#7b3f00;font-size:.9rem;border-left:5px solid #FFD600;}
.info-pill{display:inline-flex;align-items:center;gap:5px;background:linear-gradient(90deg,#f3e8ff,#e8f5e9);border-radius:50px;padding:5px 13px;font-size:.85rem;font-weight:700;color:#5c35a0;margin:3px;cursor:pointer;transition:transform .15s;}
.info-pill:hover{transform:scale(1.12);}
.beat{animation:beat 1.4s ease infinite;display:inline-block;}
@keyframes beat{0%,100%{transform:scale(1)}50%{transform:scale(1.2)}}
.poem-box{background:linear-gradient(135deg,#f3e8ff,#E1BEE7);border-radius:15px;padding:15px 17px;margin-top:12px;border-left:5px solid #9C6FDE;}
.leap-box{background:linear-gradient(135deg,#e8f5e9,#C8E6C9);border-radius:15px;padding:15px;margin-top:12px;border-left:5px solid #66BB6A;}
.section-title{font-family:"Baloo 2",cursive;font-size:1.05rem;font-weight:800;color:#9C6FDE;margin-bottom:7px;}
.modal-overlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,.45);z-index:500;align-items:center;justify-content:center;backdrop-filter:blur(4px);}
.modal-overlay.open{display:flex;}
.modal-box{background:#fff;border-radius:26px;padding:30px 26px;max-width:370px;width:92%;text-align:center;box-shadow:0 20px 60px rgba(0,0,0,.22);animation:pIn .4s cubic-bezier(.36,1.56,.64,1);}
.modal-box h2{font-family:"Baloo 2",cursive;font-size:1.8rem;font-weight:800;color:#5c35a0;margin-bottom:8px;}
.modal-close{background:linear-gradient(135deg,#9C6FDE,#E040FB);color:#fff;border:none;border-radius:50px;padding:10px 28px;font-family:"Baloo 2",cursive;font-weight:700;font-size:1rem;cursor:pointer;transition:transform .15s;margin-top:14px;display:inline-block;}
.modal-close:hover{transform:scale(1.07);}
.toast{position:fixed;bottom:26px;left:50%;transform:translateX(-50%) translateY(20px);background:linear-gradient(135deg,#9C6FDE,#E040FB);color:#fff;font-family:"Baloo 2",cursive;font-weight:700;font-size:1rem;padding:10px 24px;border-radius:50px;box-shadow:0 8px 24px rgba(156,111,222,.4);z-index:9999;opacity:0;transition:all .35s cubic-bezier(.36,1.56,.64,1);white-space:nowrap;pointer-events:none;}
.toast.show{opacity:1;transform:translateX(-50%) translateY(0);}
.conf{position:fixed;width:10px;height:10px;border-radius:2px;pointer-events:none;z-index:999;animation:confFall 1.4s ease-in forwards;}
@keyframes confFall{0%{opacity:1;transform:translateY(-20px) rotate(0deg)}100%{opacity:0;transform:translateY(88vh) rotate(720deg)}}
.cq-wrap{display:flex;flex-direction:column;align-items:center;gap:12px;padding:6px 0;}
@media(max-width:500px){.quiz-opts{grid-template-columns:1fr}.ampm-wrap{grid-template-columns:1fr}.dir-cards{grid-template-columns:1fr}.clock-svg-wrap{width:200px;height:200px}}
</style>
</head>
<body>
<div class="particle" style="left:4%;animation-duration:13s;animation-delay:0s">â­</div>
<div class="particle" style="left:14%;animation-duration:9s;animation-delay:2s">ğŸŒŸ</div>
<div class="particle" style="left:28%;animation-duration:15s;animation-delay:4s">âœ¨</div>
<div class="particle" style="left:42%;animation-duration:10s;animation-delay:1s">ğŸŒ™</div>
<div class="particle" style="left:58%;animation-duration:12s;animation-delay:3s">â˜€ï¸</div>
<div class="particle" style="left:72%;animation-duration:8s;animation-delay:5s">â­</div>
<div class="particle" style="left:88%;animation-duration:14s;animation-delay:2s">ğŸŒˆ</div>
<header>
  <div class="mascot" id="mascot">ğŸ¦‰</div>
  <h1>â° Time &amp; Directions Adventure! ğŸ§­</h1>
  <p style="color:#6d4c9f;font-weight:700;font-size:1rem;">Welcome, Explorer! Learn, Play &amp; Earn Stars!</p>
  <div class="starbar" onclick="showStarCelebration()">
    <span class="beat">â­</span><span>Stars:</span>
    <span class="star-num" id="star-display">0</span>
    &nbsp;ğŸ† Badges: <span id="badge-count">0</span>
  </div>
</header>
<nav>
  <button class="nb1 active" onclick="showPanel('learn',this)">ğŸ“– Learn Time</button>
  <button class="nb2" onclick="showPanel('clock',this)">ğŸ• Clock Fun</button>
  <button class="nb3" onclick="showPanel('calendar',this)">ğŸ“… Calendar</button>
  <button class="nb4" onclick="showPanel('directions',this)">ğŸ§­ Directions</button>
  <button class="nb5" onclick="showPanel('quiz',this)">ğŸ¯ Quiz!</button>
  <button class="nb6" onclick="showPanel('rewards',this)">ğŸ† Rewards</button>
</nav>

<!-- LEARN -->
<div id="learn-panel" class="panel active">
<div class="card">
  <h2>â˜€ï¸ Drag the Sun Across the Sky!</h2>
  <div class="sky-scene" id="sky-scene">
    <div id="clouds-layer"></div>
    <div class="sky-label" id="sky-label">ğŸŒ… Morning</div>
    <div class="drag-sun" id="drag-sun" style="left:5%;top:55%;transform:translateY(-50%)">ğŸŒ…</div>
    <div class="drag-hint">â˜ï¸ Drag the sun!</div>
  </div>
  <div class="tod-grid">
    <div class="tod-card tod-morning" onclick="clickTod(this,'morning')"><span class="ti">ğŸŒ…</span><strong>Morning</strong><div style="font-size:.75rem;margin-top:3px">Sun rises in the East</div></div>
    <div class="tod-card tod-noon" onclick="clickTod(this,'noon')"><span class="ti">â˜€ï¸</span><strong>Noon</strong><div style="font-size:.75rem;margin-top:3px">Sun over our head</div></div>
    <div class="tod-card tod-afternoon" onclick="clickTod(this,'afternoon')"><span class="ti">ğŸŒ¤ï¸</span><strong>Afternoon</strong><div style="font-size:.75rem;margin-top:3px">Between noon &amp; evening</div></div>
    <div class="tod-card tod-evening" onclick="clickTod(this,'evening')"><span class="ti">ğŸŒ‡</span><strong>Evening</strong><div style="font-size:.75rem;margin-top:3px">Sun sets in the West</div></div>
    <div class="tod-card tod-night" onclick="clickTod(this,'night')"><span class="ti">ğŸŒ™</span><strong>Night</strong><div style="font-size:.75rem;margin-top:3px">Stars come out!</div></div>
  </div>
  <div id="tod-info" class="fact-box" style="display:none;margin-top:12px;"></div>
</div>
<div class="card">
  <h2>â±ï¸ Time Units â€” Tap Each!</h2>
  <div class="unit-chain" id="unit-chain"></div>
  <div id="unit-info" style="min-height:44px;margin-top:7px;font-weight:700;font-size:.97rem;color:#5c35a0;text-align:center;"></div>
</div>
<div class="card">
  <h2>ğŸ”„ A.M. &amp; P.M. â€” Tap to Flip!</h2>
  <p style="margin-bottom:11px;">Tap each card to flip and learn!</p>
  <div class="ampm-wrap">
    <div class="ampm-flip" onclick="this.classList.toggle('flipped')">
      <div class="ampm-inner">
        <div class="af am"><div class="abig">a.m.</div><div style="font-size:.85rem;margin-top:3px">Tap to flip!</div></div>
        <div class="ab am2"><div class="abig">ğŸŒ…â†’â˜€ï¸</div><div style="font-size:.82rem;margin-top:5px;text-align:center;">Midnight to Noon<br>12:00am â†’ 12:00pm</div></div>
      </div>
    </div>
    <div class="ampm-flip" onclick="this.classList.toggle('flipped')">
      <div class="ampm-inner">
        <div class="af pm"><div class="abig">p.m.</div><div style="font-size:.85rem;margin-top:3px">Tap to flip!</div></div>
        <div class="ab pm2"><div class="abig">ğŸŒ‡â†’ğŸŒ™</div><div style="font-size:.82rem;margin-top:5px;text-align:center;">Noon to Midnight<br>12:00pm â†’ 12:00am</div></div>
      </div>
    </div>
  </div>
  <div class="fact-box" style="margin-top:13px;">ğŸ’¡ <strong>Noon</strong> = 12:00 midday &nbsp;|&nbsp; <strong>Midnight</strong> = 12:00 at night</div>
</div>
</div>

<!-- CLOCK -->
<div id="clock-panel" class="panel">
<div class="card">
  <h2>ğŸ• Interactive Clock</h2>
  <p class="spin-hint">â˜ï¸ Drag around the clock face OR use the buttons!</p>
  <div style="display:flex;flex-direction:column;align-items:center;gap:13px;">
    <div class="clock-svg-wrap" id="clock-wrap">
      <svg id="interactive-clock" width="230" height="230" viewBox="0 0 240 240">
        <defs><radialGradient id="cg" cx="38%" cy="33%"><stop offset="0%" stop-color="#f3e8ff"/><stop offset="100%" stop-color="#ddd0f8"/></radialGradient></defs>
        <circle cx="120" cy="120" r="116" fill="white" stroke="#E0D0F8" stroke-width="5"/>
        <circle cx="120" cy="120" r="109" fill="url(#cg)"/>
        <g id="tick-marks"></g>
        <g id="clock-numbers"></g>
        <line id="hour-hand" x1="120" y1="120" x2="120" y2="70" stroke="#5c35a0" stroke-width="7" stroke-linecap="round"/>
        <line id="minute-hand" x1="120" y1="120" x2="120" y2="46" stroke="#FF7EB3" stroke-width="4.5" stroke-linecap="round"/>
        <line id="second-hand" x1="120" y1="120" x2="120" y2="38" stroke="#FF5252" stroke-width="2.5" stroke-linecap="round" style="display:none"/>
        <circle cx="120" cy="120" r="7" fill="#5c35a0"/><circle cx="120" cy="120" r="3" fill="white"/>
      </svg>
    </div>
    <div class="clock-time-display" id="clock-time-text">12:00</div>
    <div style="font-size:.95rem;font-weight:700;color:#9C6FDE;" id="clock-ampm-label">p.m.</div>
    <div class="clock-controls">
      <button class="cbtn" onclick="changeHour(-1)">â—€ Hour</button>
      <button class="cbtn" onclick="changeHour(1)">Hour â–¶</button>
      <button class="cbtn" onclick="changeMin(-5)">â—€ 5 min</button>
      <button class="cbtn" onclick="changeMin(5)">5 min â–¶</button>
      <button class="cbtn" onclick="setNow()">â± Live!</button>
      <button class="cbtn" onclick="toggleSec()">ğŸ”´ Seconds</button>
    </div>
  </div>
  <div class="fact-box" style="margin-top:14px;">ğŸ’¡ <strong>Short hand</strong> = hours &nbsp;|&nbsp; <strong>Long hand</strong> = minutes &nbsp;|&nbsp; <strong>Red</strong> = seconds</div>
</div>
<div class="card">
  <h2>ğŸ¯ Set the Time Challenge!</h2>
  <p>Use the clock above to show the target time, then check!</p>
  <div class="set-time-card">
    <div style="font-size:.95rem;font-weight:700;color:#5c35a0;">Set the clock to:</div>
    <div class="target-t" id="target-time">--:--</div>
    <button class="cbtn" onclick="checkSetTime()" style="margin:4px auto;display:block;">âœ… Check!</button>
    <div id="set-time-result" style="font-family:'Baloo 2',cursive;font-size:1.1rem;font-weight:800;min-height:30px;margin-top:6px;"></div>
  </div>
</div>
<div class="card">
  <h2>ğŸ–¼ï¸ Clock Reading Challenge</h2>
  <p style="margin-bottom:7px;">What time does this clock show?</p>
  <div class="cq-wrap">
    <svg id="cq-clock" width="175" height="175" viewBox="0 0 240 240">
      <circle cx="120" cy="120" r="116" fill="white" stroke="#E0D0F8" stroke-width="5"/>
      <circle cx="120" cy="120" r="109" fill="#f3e8ff"/>
      <g id="cq-numbers"></g>
      <line id="cq-hour" x1="120" y1="120" x2="120" y2="70" stroke="#5c35a0" stroke-width="7" stroke-linecap="round"/>
      <line id="cq-minute" x1="120" y1="120" x2="120" y2="46" stroke="#FF7EB3" stroke-width="4.5" stroke-linecap="round"/>
      <circle cx="120" cy="120" r="7" fill="#5c35a0"/>
    </svg>
    <div class="quiz-opts" id="cq-options" style="width:100%;max-width:330px;"></div>
    <div class="quiz-fb" id="cq-feedback"></div>
  </div>
</div>
</div>

<!-- CALENDAR -->
<div id="calendar-panel" class="panel">
<div class="card">
  <h2>ğŸ“… February 2026</h2>
  <p style="margin-bottom:9px;">Today is highlighted! <strong>Click any date</strong> to find out what day of the week it is.</p>
  <div class="cal-grid" id="cal-grid"></div>
  <div class="fact-box">ğŸ“ Today: <strong id="today-label"></strong></div>
</div>
<div class="card">
  <h2>ğŸ—“ï¸ Days of the Week â€” Drag to Order!</h2>
  <p style="margin-bottom:9px;">Drag the days into the correct order! <strong>Sunday goes first.</strong></p>
  <div class="drag-match">
    <div class="drag-src" id="day-source"></div>
    <div class="drag-tgt" id="day-targets"></div>
  </div>
  <button class="next-btn" onclick="checkDayOrder()" style="margin-top:10px;background:linear-gradient(135deg,#66BB6A,#26A69A);">âœ… Check Order!</button>
  <div id="day-order-result" style="text-align:center;font-family:'Baloo 2',cursive;font-size:1.15rem;font-weight:800;margin-top:9px;min-height:28px;"></div>
</div>
<div class="card">
  <h2>ğŸ—“ï¸ All 12 Months â€” Tap Each!</h2>
  <div class="months-grid" id="months-grid"></div>
  <div id="month-info-box" style="min-height:46px;margin-top:11px;text-align:center;font-family:'Baloo 2',cursive;font-size:1.1rem;font-weight:800;color:#5c35a0;"></div>
  <div class="leap-box"><div class="section-title">ğŸ¸ Leap Year!</div><p>Every <strong>4th year</strong>, February gets <strong>29 days</strong> â€” that year has <strong>366 days</strong> and is called a <strong>Leap Year!</strong> Next leap year: 2028.</p></div>
  <div class="poem-box">
    <div class="section-title" style="margin-bottom:4px;">ğŸµ Days-in-a-Month Poem â€” tap each line!</div>
    <div id="poem-lines"></div>
  </div>
</div>
</div>

<!-- DIRECTIONS -->
<div id="directions-panel" class="panel">
<div class="card">
  <h2>ğŸ§­ Spin the Compass!</h2>
  <p style="margin-bottom:12px;"><strong>Spin the compass</strong> by dragging. Click each direction label to learn!</p>
  <div style="display:flex;flex-direction:column;align-items:center;gap:14px;">
    <div class="compass-outer" id="compass-outer">
      <div class="compass-inner" id="compass-inner">
        <div style="display:flex;flex-direction:column;align-items:center;position:relative;height:100%;justify-content:center;">
          <div style="width:0;height:0;border-left:6px solid transparent;border-right:6px solid transparent;border-bottom:40px solid #E64A19;"></div>
          <div style="width:11px;height:11px;background:#5c35a0;border-radius:50%;margin:-1px 0;z-index:2;"></div>
          <div style="width:0;height:0;border-left:6px solid transparent;border-right:6px solid transparent;border-top:40px solid #bbb;"></div>
        </div>
        <span class="clabel cn" onclick="showDirInfo('North','â¬†ï¸ North â€” When you face the rising Sun (East), your LEFT hand points North!')">N</span>
        <span class="clabel cs" onclick="showDirInfo('South','â¬‡ï¸ South â€” When you face East, your RIGHT hand points South!')">S</span>
        <span class="clabel ce" onclick="showDirInfo('East','â¡ï¸ East â€” The Sun RISES in the East every morning!')">E</span>
        <span class="clabel cw" onclick="showDirInfo('West','â¬…ï¸ West â€” The Sun SETS in the West every evening!')">W</span>
      </div>
    </div>
    <div class="dir-cards" style="width:100%;">
      <div class="dir-card dir-n" onclick="showDirInfo('North','â¬†ï¸ North â€” When you face the rising Sun (East), your LEFT hand points North. The compass always points North!')"><span class="dir-letter">N</span><strong>â¬†ï¸ North</strong><p style="font-size:.8rem;margin-top:3px">Left hand when facing East</p></div>
      <div class="dir-card dir-s" onclick="showDirInfo('South','â¬‡ï¸ South â€” When you face East, your RIGHT hand points South!')"><span class="dir-letter">S</span><strong>â¬‡ï¸ South</strong><p style="font-size:.8rem;margin-top:3px">Right hand when facing East</p></div>
      <div class="dir-card dir-e" onclick="showDirInfo('East','â¡ï¸ East â€” The Sun rises in the East every single morning!')"><span class="dir-letter">E</span><strong>â¡ï¸ East</strong><p style="font-size:.8rem;margin-top:3px">Sun rises here every day</p></div>
      <div class="dir-card dir-w" onclick="showDirInfo('West','â¬…ï¸ West â€” The Sun sets in the West every evening. Your back faces West when you face East!')"><span class="dir-letter">W</span><strong>â¬…ï¸ West</strong><p style="font-size:.8rem;margin-top:3px">Sun sets here every day</p></div>
    </div>
    <div class="fact-box" style="width:100%;">ğŸ§² A <strong>compass</strong> always points to the <strong>North</strong> â€” travellers use it to find their way!</div>
  </div>
</div>
<div class="card">
  <h2>ğŸ™‹ Position Words â€” Move the Girl!</h2>
  <div class="pos-scene" id="pos-scene">
    <div class="pos-object" id="pos-tree" style="right:16px;top:12px">ğŸŒ³</div>
    <div class="pos-object" id="pos-girl" style="left:42%;top:38%;transform:translateX(-50%)">ğŸ‘§</div>
    <div class="pos-object" id="pos-boy" style="left:16px;bottom:20px">ğŸ‘¦</div>
  </div>
  <div class="pos-word-btns">
    <button class="pos-btn" onclick="moveGirl('left')">ğŸ‘ˆ Left</button>
    <button class="pos-btn" onclick="moveGirl('right')">ğŸ‘‰ Right</button>
    <button class="pos-btn" onclick="moveGirl('up')">â¬†ï¸ Up</button>
    <button class="pos-btn" onclick="moveGirl('down')">â¬‡ï¸ Down</button>
    <button class="pos-btn" onclick="moveGirl('near')">ğŸ¤ Near tree</button>
    <button class="pos-btn" onclick="moveGirl('far')">ğŸ“ Far</button>
    <button class="pos-btn" onclick="moveGirl('front')">ğŸš¶ Front of boy</button>
    <button class="pos-btn" onclick="moveGirl('behind')">ğŸ”™ Behind boy</button>
    <button class="pos-btn" onclick="moveGirl('above')">â¬† Above all</button>
    <button class="pos-btn" onclick="moveGirl('below')">â¬‡ Below</button>
    <button class="pos-btn" onclick="moveGirl('reset')" style="background:#f3e8ff;">ğŸ”„ Reset</button>
  </div>
  <div id="pos-label" style="text-align:center;font-family:'Baloo 2',cursive;font-size:1.05rem;font-weight:800;color:#5c35a0;margin-top:7px;min-height:26px;"></div>
</div>
<div class="card">
  <h2>ğŸ—ºï¸ Maze â€” Help Sonu Get Home!</h2>
  <p style="margin-bottom:7px;">Use arrow buttons to guide ğŸ§’ Sonu to the ğŸ  home!</p>
  <div class="maze-wrap"><canvas class="maze-canvas" id="maze-canvas" width="400" height="300"></canvas></div>
  <div class="maze-controls">
    <button class="mbtn" onclick="mazeMovePlayer(0,-1)">â¬†ï¸</button>
    <button class="mbtn" onclick="mazeMovePlayer(-1,0)">â¬…ï¸</button>
    <button class="mbtn" onclick="mazeMovePlayer(1,0)">â¡ï¸</button>
    <button class="mbtn" onclick="mazeMovePlayer(0,1)">â¬‡ï¸</button>
    <button class="mbtn" onclick="resetMaze()" style="background:linear-gradient(135deg,#FF7EB3,#FF4081);">ğŸ”„ Reset</button>
  </div>
  <div id="maze-result" style="text-align:center;font-family:'Baloo 2',cursive;font-size:1.15rem;font-weight:800;color:#5c35a0;margin-top:7px;min-height:26px;"></div>
</div>
</div>

<!-- QUIZ -->
<div id="quiz-panel" class="panel">
<div class="card">
  <h2>ğŸ¯ Knowledge Quiz!</h2>
  <p style="margin-bottom:12px;">Answer correctly to earn â­ stars and unlock badges!</p>
  <div class="quiz-progress" id="quiz-progress"></div>
  <div style="background:var(--card);border-radius:18px;padding:20px;box-shadow:var(--shadow);border:2px solid rgba(255,255,255,.85);">
    <div class="quiz-q" id="quiz-q"></div>
    <div class="quiz-opts" id="quiz-opts"></div>
    <div class="quiz-fb" id="quiz-feedback"></div>
    <button class="next-btn" id="next-btn" onclick="nextQuestion()" style="display:none;">Next â¡ï¸</button>
  </div>
  <div style="text-align:center;margin-top:12px;">
    <button class="next-btn" onclick="initQuiz()" style="background:linear-gradient(135deg,#66BB6A,#26A69A);">ğŸ”„ Restart Quiz</button>
  </div>
</div>
</div>

<!-- REWARDS -->
<div id="rewards-panel" class="panel">
<div class="card">
  <h2>ğŸ† Your Badges!</h2>
  <p style="margin-bottom:14px;">Earn stars by playing and completing the quiz. Click any badge to see its details!</p>
  <div class="starbar" style="display:inline-flex;margin:0 auto 18px;">
    <span class="beat">â­</span><span>Total Stars:</span>
    <span class="star-num" id="star-display-2">0</span>
  </div>
  <div class="badges-grid" id="badges-grid"></div>
</div>
</div>

<div class="modal-overlay" id="modal">
  <div class="modal-box">
    <div style="font-size:3.5rem;" id="modal-icon">ğŸ‰</div>
    <h2 id="modal-title">Awesome!</h2>
    <p id="modal-msg" style="font-size:1rem;color:#555;"></p>
    <button class="modal-close" onclick="closeModal()">Yay! âœ¨</button>
  </div>
</div>
<div class="toast" id="toast"></div>

<script>
var stars=parseInt(localStorage.getItem("stars")||"0");
var unlockedBadges=JSON.parse(localStorage.getItem("badges")||"[]");
var monthsVisited=new Set(JSON.parse(localStorage.getItem("mv")||"[]"));
var daysVisited=new Set(JSON.parse(localStorage.getItem("dv")||"[]"));
var clockH=12,clockM=0,secOn=false,secInt=null;
var quizIndex=0,quizScore=0,quizAnswered=false,shuffledQ=[];
var setTimeTgt={h:3,m:0,ampm:"a.m."};
var dirExplored=new Set();
var clockClicks=0;
var cqIdx=0;
var dayOrderState=Array(7).fill(null);
var mazeGrid=[],playerX=0,playerY=0,mazeWon=false;
var MAZE_COLS=8,MAZE_ROWS=6,CELL=50;

function saveState(){localStorage.setItem("stars",stars);localStorage.setItem("badges",JSON.stringify(unlockedBadges));localStorage.setItem("mv",JSON.stringify([...monthsVisited]));localStorage.setItem("dv",JSON.stringify([...daysVisited]));}

// BADGES
var BADGES=[
  {id:"first_star",icon:"ğŸŒŸ",name:"First Star!",desc:"Earned your very first star"},
  {id:"clock5",icon:"ğŸ•",name:"Clock Watcher",desc:"Explored the clock many times"},
  {id:"months_all",icon:"ğŸ“…",name:"Month Master",desc:"Visited all 12 months"},
  {id:"quiz_half",icon:"ğŸ¯",name:"Quiz Starter",desc:"Got 5 quiz questions right"},
  {id:"quiz_all",icon:"ğŸ…",name:"Quiz Champion",desc:"Completed the full quiz!"},
  {id:"perfect",icon:"ğŸ’",name:"Perfect Score",desc:"100% correct on the quiz!"},
  {id:"star10",icon:"â­",name:"Star Collector",desc:"Earned 10 stars"},
  {id:"star25",icon:"ğŸ’«",name:"Super Learner",desc:"Earned 25 stars"},
  {id:"star50",icon:"ğŸš€",name:"Space Explorer",desc:"Earned 50 stars"},
  {id:"maze_win",icon:"ğŸ—ºï¸",name:"Pathfinder",desc:"Solved the directions maze!"},
  {id:"days_order",icon:"ğŸ“†",name:"Week Wizard",desc:"Got the days of the week right"},
  {id:"all_dir",icon:"ğŸ§­",name:"Direction Hero",desc:"Explored all 4 main directions"},
];

function awardStar(n){
  stars+=n;
  var el=document.getElementById("star-display");
  el.textContent=stars;el.classList.add("pop");
  setTimeout(function(){el.classList.remove("pop");},350);
  document.getElementById("star-display-2").textContent=stars;
  checkBadges();saveState();
  if(n>0)spawnConfetti(14);
}
function checkBadges(){
  var nb=null;
  function give(id){if(!unlockedBadges.includes(id)){unlockedBadges.push(id);nb=id;}}
  if(stars>=1)give("first_star");
  if(clockClicks>=5)give("clock5");
  if(monthsVisited.size>=12)give("months_all");
  if(quizScore>=5)give("quiz_half");
  if(stars>=10)give("star10");
  if(stars>=25)give("star25");
  if(stars>=50)give("star50");
  if(dirExplored.size>=4)give("all_dir");
  if(nb){var b=BADGES.find(function(x){return x.id===nb;});if(b){showToast(b.icon+" Badge Unlocked: "+b.name+"!");renderBadges();}}
  document.getElementById("badge-count").textContent=unlockedBadges.length;
  renderBadges();
}
function renderBadges(){
  var g=document.getElementById("badges-grid");if(!g)return;g.innerHTML="";
  BADGES.forEach(function(b){
    var u=unlockedBadges.includes(b.id);
    var d=document.createElement("div");d.className="badge"+(u?"":" locked");
    d.innerHTML="<span class='bi'>"+b.icon+"</span><div class='bn'>"+b.name+"</div><div class='bd'>"+b.desc+"</div>"+(u?"":"<div class='lk'>ğŸ”’</div>");
    d.onclick=function(){if(u)showModalMsg(b.icon,b.name,b.desc);else showToast("ğŸ”’ Keep playing to unlock!");};
    g.appendChild(d);
  });
}

// TOAST/MODAL/CONFETTI
var toastTimer;
function showToast(msg){var t=document.getElementById("toast");t.textContent=msg;t.classList.add("show");clearTimeout(toastTimer);toastTimer=setTimeout(function(){t.classList.remove("show");},2800);}
function showModalMsg(icon,title,msg){document.getElementById("modal-icon").textContent=icon;document.getElementById("modal-title").textContent=title;document.getElementById("modal-msg").textContent=msg;document.getElementById("modal").classList.add("open");}
function closeModal(){document.getElementById("modal").classList.remove("open");}
function spawnConfetti(n){n=n||16;var colors=["#FF7EB3","#FFD600","#4FC3F7","#66BB6A","#9C6FDE","#FF8C42","#FF5252"];for(var i=0;i<n;i++){var el=document.createElement("div");el.className="conf";el.style.left=Math.random()*100+"vw";el.style.background=colors[Math.floor(Math.random()*colors.length)];el.style.animationDuration=(1+Math.random()*1.2)+"s";el.style.animationDelay=Math.random()*0.4+"s";el.style.borderRadius=Math.random()>.5?"50%":"2px";var s=(8+Math.random()*8)+"px";el.style.width=el.style.height=s;document.body.appendChild(el);setTimeout(function(){el.remove();},2200);}}
function showStarCelebration(){spawnConfetti(30);showToast("â­ You have "+stars+" stars! Keep it up!");}

// PANEL NAV
function showPanel(id,btn){
  document.querySelectorAll(".panel").forEach(function(p){p.classList.remove("active");});
  document.getElementById(id+"-panel").classList.add("active");
  document.querySelectorAll("nav button").forEach(function(b){b.classList.remove("active");});
  if(btn)btn.classList.add("active");
  if(id==="clock"){renderClockNumbers();renderCQNumbers();renderClockQuiz();newSetTimeTgt();}
  if(id==="calendar"){renderCalendar();}
  if(id==="rewards"){renderBadges();document.getElementById("star-display-2").textContent=stars;}
  if(id==="directions"){initMaze();}
  if(id==="quiz"){initQuiz();}
}

// MASCOT
var mq=["Hoot! Drag the sun across the sky! â˜€ï¸","You're doing great! ğŸ¦‰","Try the quiz next!","Spin the compass!","Tap the month cards!","Click the time cards to learn more!"];var mqIdx=0;
document.getElementById("mascot").onclick=function(){showToast("ğŸ¦‰ "+mq[mqIdx%mq.length]);mqIdx++;};

// SKY DRAGGABLE SUN
var skyStates=[
  {pct:0.05,emoji:"ğŸŒ…",label:"ğŸŒ… Morning",bg:"linear-gradient(180deg,#FFE082 0%,#87CEEB 40%,#87CEEB 75%,#5DBB63 75%,#4CAF50 100%)",info:"â˜€ï¸ The Sun rises in the <strong>East</strong>. This is morning â€” our day begins! Birds sing and everything wakes up. ğŸ¦"},
  {pct:0.30,emoji:"ğŸŒ¤ï¸",label:"ğŸŒ¤ï¸ Mid-Morning",bg:"linear-gradient(180deg,#87CEEB 0%,#B3E5FC 75%,#5DBB63 75%,#4CAF50 100%)",info:"ğŸŒ¤ï¸ Mid-morning! The Sun has risen higher. A great time to go to school! âœï¸"},
  {pct:0.50,emoji:"â˜€ï¸",label:"â˜€ï¸ Noon",bg:"linear-gradient(180deg,#64B5F6 0%,#87CEEB 75%,#5DBB63 75%,#4CAF50 100%)",info:"<strong>Noon!</strong> The Sun is right over our heads. It is 12:00 in the middle of the day â€” very bright and hot! ğŸŒ¡ï¸"},
  {pct:0.68,emoji:"ğŸŒ¤ï¸",label:"ğŸŒ¤ï¸ Afternoon",bg:"linear-gradient(180deg,#B3E5FC 0%,#87CEEB 75%,#5DBB63 75%,#4CAF50 100%)",info:"ğŸŒ¤ï¸ <strong>Afternoon</strong> â€” between noon and evening. The Sun starts moving towards the West. ğŸŒ¤ï¸"},
  {pct:0.85,emoji:"ğŸŒ‡",label:"ğŸŒ‡ Evening",bg:"linear-gradient(180deg,#FF8A65 0%,#CE93D8 50%,#7B1FA2 75%,#4CAF50 85%,#388E3C 100%)",info:"ğŸŒ‡ The Sun sets in the <strong>West</strong> during evening. The sky turns beautiful orange and pink!"},
  {pct:0.98,emoji:"ğŸŒ™",label:"ğŸŒ™ Night",bg:"linear-gradient(180deg,#1a1a4e 0%,#283593 60%,#3949AB 80%,#2E7D32 85%,#1B5E20 100%)",info:"ğŸŒ™ <strong>Night</strong> â€” the Sun has set. Stars come out. 12:00 at night is called <strong>midnight</strong>. Time to sleep! ğŸ˜´"},
];
var lastSkyState=-1;
var isDraggingSun=false;
var sunEl=document.getElementById("drag-sun");
var skyEl=document.getElementById("sky-scene");
function getSkyState(pct){var best=0;for(var i=0;i<skyStates.length;i++){if(pct>=skyStates[i].pct)best=i;}return best;}
function updateSky(pct){var i=getSkyState(pct);if(i!==lastSkyState){lastSkyState=i;var s=skyStates[i];skyEl.style.background=s.bg;document.getElementById("sky-label").textContent=s.label;sunEl.textContent=s.emoji;var box=document.getElementById("tod-info");box.style.display="block";box.innerHTML="ğŸ’¡ "+s.info;}}
function handleSunMove(clientX,clientY){var rect=skyEl.getBoundingClientRect();var pct=Math.max(0,Math.min(.98,(clientX-rect.left)/rect.width));var yPct=Math.max(.05,Math.min(.8,(clientY-rect.top)/rect.height));sunEl.style.left=(pct*100-3)+"%";sunEl.style.top=(yPct*100)+"%";updateSky(pct);}
sunEl.addEventListener("mousedown",function(e){isDraggingSun=true;e.preventDefault();});
sunEl.addEventListener("touchstart",function(e){isDraggingSun=true;e.preventDefault();},{passive:false});
document.addEventListener("mousemove",function(e){if(isDraggingSun)handleSunMove(e.clientX,e.clientY);});
document.addEventListener("touchmove",function(e){if(isDraggingSun){e.preventDefault();handleSunMove(e.touches[0].clientX,e.touches[0].clientY);}},{passive:false});
document.addEventListener("mouseup",function(){isDraggingSun=false;});
document.addEventListener("touchend",function(){isDraggingSun=false;});
// Clouds
(function(){var cl=document.getElementById("clouds-layer");for(var i=0;i<4;i++){var c=document.createElement("div");c.className="cloud";c.textContent="â˜ï¸";c.style.top=(5+Math.random()*30)+"%";c.style.left="-80px";c.style.animationDuration=(18+Math.random()*20)+"s";c.style.animationDelay=-(Math.random()*20)+"s";c.style.fontSize=(1.1+Math.random())+"rem";c.style.opacity=0.4+Math.random()*.3;c.style.position="absolute";cl.appendChild(c);}})();

// TOD CARDS
var todData={
  morning:{title:"ğŸŒ… Morning",info:"The Sun rises in the <strong>East</strong>. This is when our day begins! Birds start singing and everything gets bright."},
  noon:{title:"â˜€ï¸ Noon",info:"The Sun is right over our head at <strong>noon</strong> â€” 12:00 in the middle of the day. Neither a.m. nor p.m. â€” it is exactly noon!"},
  afternoon:{title:"ğŸŒ¤ï¸ Afternoon",info:"<strong>Afternoon</strong> is the time between noon and evening. The Sun starts moving towards the West."},
  evening:{title:"ğŸŒ‡ Evening",info:"The Sun sets in the <strong>West</strong> in the evening. The sky turns beautiful orange and pink!"},
  night:{title:"ğŸŒ™ Night",info:"After sunset, it is night. Stars appear! 12:00 at night is called <strong>midnight</strong>. Time to rest! ğŸ˜´"},
};
function clickTod(el,tod){
  var r=document.createElement("div");r.className="ripple";var s=Math.max(el.offsetWidth,el.offsetHeight)*2;r.style.width=r.style.height=s+"px";r.style.left=r.style.top="50%";r.style.marginLeft=r.style.marginTop=(-s/2)+"px";el.appendChild(r);setTimeout(function(){r.remove();},700);
  var box=document.getElementById("tod-info");box.style.display="block";box.innerHTML="ğŸ’¡ <strong>"+todData[tod].title+"</strong> â€” "+todData[tod].info;
}

// UNIT CHAIN
var units=[
  {label:"1 second",info:"â±ï¸ A second is tiny! Count 1... that's one second. 60 of these make a minute."},
  {label:"60 sec = 1 min",info:"ğŸ• 60 seconds make 1 minute. Count to 60 â€” that's one minute!"},
  {label:"60 min = 1 hr",info:"ğŸ• 60 minutes make 1 hour. A school lesson is about 1 hour long!"},
  {label:"24 hrs = 1 day",info:"ğŸŒ 24 hours make 1 full day â€” from midnight all the way to the next midnight!"},
  {label:"7 days = 1 week",info:"ğŸ“… 7 days make 1 week: Sunday, Monday, Tuesday, Wednesday, Thursday, Friday, Saturday!"},
  {label:"~4 wks = 1 month",info:"ğŸ—“ï¸ About 4 weeks (plus 2-3 extra days) make 1 month. Months have 28, 30, or 31 days."},
  {label:"12 months = 1 yr",info:"ğŸ“† 12 months make 1 year! One year = 365 days (or 366 in a leap year!)."},
];
function buildUnitChain(){
  var chain=document.getElementById("unit-chain");chain.innerHTML="";
  units.forEach(function(u,i){
    var b=document.createElement("div");b.className="unit-block";b.textContent=u.label;
    b.onclick=function(){document.getElementById("unit-info").innerHTML="<div style='animation:popIn .35s cubic-bezier(.36,1.56,.64,1) both'>"+u.info+"</div>";document.querySelectorAll(".unit-block").forEach(function(x){x.classList.remove("active-unit");});b.classList.add("active-unit");};
    chain.appendChild(b);
    if(i<units.length-1){var a=document.createElement("div");a.className="unit-arrow";a.textContent="â†’";chain.appendChild(a);}
  });
}

// CLOCK
function renderClockNumbers(){
  ["clock-numbers","cq-numbers"].forEach(function(id){
    var g=document.getElementById(id);if(!g)return;g.innerHTML="";
    for(var i=0;i<60;i++){var a=(i/60)*Math.PI*2-Math.PI/2;var r1=i%5===0?93:98,r2=103;var line=document.createElementNS("http://www.w3.org/2000/svg","line");line.setAttribute("x1",120+Math.cos(a)*r1);line.setAttribute("y1",120+Math.sin(a)*r1);line.setAttribute("x2",120+Math.cos(a)*r2);line.setAttribute("y2",120+Math.sin(a)*r2);line.setAttribute("stroke",i%5===0?"#9C6FDE":"#ddd");line.setAttribute("stroke-width",i%5===0?"2":"1");g.appendChild(line);}
    for(var i=1;i<=12;i++){var a=(i/12)*Math.PI*2-Math.PI/2;var x=120+Math.cos(a)*80,y=120+Math.sin(a)*80;var t=document.createElementNS("http://www.w3.org/2000/svg","text");t.setAttribute("x",x);t.setAttribute("y",y);t.setAttribute("text-anchor","middle");t.setAttribute("dominant-baseline","middle");t.setAttribute("font-family","Baloo 2");t.setAttribute("font-weight","700");t.setAttribute("font-size","15");t.setAttribute("fill","#5c35a0");t.textContent=i;g.appendChild(t);}
  });
  updateClockHands();
}
function setHand(id,deg,len){var el=document.getElementById(id);if(!el)return;var r=(deg-90)*Math.PI/180;el.setAttribute("x2",120+Math.cos(r)*len);el.setAttribute("y2",120+Math.sin(r)*len);}
function updateClockHands(){var hDeg=((clockH%12)+clockM/60)/12*360;setHand("hour-hand",hDeg,52);setHand("minute-hand",clockM/60*360,72);var h=clockH%12===0?12:clockH%12;document.getElementById("clock-time-text").textContent=h+":"+(clockM.toString().padStart(2,"0"));document.getElementById("clock-ampm-label").textContent=clockH<12?"a.m.":"p.m.";}
function changeHour(d){clockH=(clockH+d+24)%24;updateClockHands();clockClicks++;checkBadges();saveState();}
function changeMin(d){clockM=(clockM+d+60)%60;updateClockHands();}
function setNow(){var n=new Date();clockH=n.getHours();clockM=n.getMinutes();updateClockHands();showToast("ğŸ• Now showing the real current time!");}
function toggleSec(){secOn=!secOn;var sh=document.getElementById("second-hand");if(secOn){sh.style.display="";clearInterval(secInt);secInt=setInterval(function(){var s=new Date().getSeconds();setHand("second-hand",s/60*360,68);},1000);showToast("ğŸ”´ Second hand is moving!");}else{sh.style.display="none";clearInterval(secInt);}}
// Clock drag
var isDragClock=false;
document.getElementById("clock-wrap").addEventListener("mousedown",function(e){isDragClock=true;e.preventDefault();handleClockDrag(e);});
document.getElementById("clock-wrap").addEventListener("touchstart",function(e){isDragClock=true;e.preventDefault();handleClockDrag(e);},{passive:false});
document.addEventListener("mousemove",function(e){if(isDragClock)handleClockDrag(e);});
document.addEventListener("touchmove",function(e){if(isDragClock){e.preventDefault();handleClockDrag(e);}},{passive:false});
document.addEventListener("mouseup",function(){isDragClock=false;});
document.addEventListener("touchend",function(){isDragClock=false;});
function handleClockDrag(e){var rect=document.getElementById("interactive-clock").getBoundingClientRect();var cx=rect.left+rect.width/2,cy=rect.top+rect.height/2;var pos=e.touches?e.touches[0]:e;var angle=Math.atan2(pos.clientY-cy,pos.clientX-cx);var deg=((angle+Math.PI/2)*180/Math.PI+360)%360;clockM=Math.round(deg/6)%60;updateClockHands();clockClicks++;checkBadges();}

// SET TIME
function newSetTimeTgt(){var h=Math.floor(Math.random()*12)+1;var mArr=[0,15,30,45];var m=mArr[Math.floor(Math.random()*4)];var ampm=Math.random()>.5?"a.m.":"p.m.";setTimeTgt={h:h,m:m,ampm:ampm};document.getElementById("target-time").textContent=h+":"+(m.toString().padStart(2,"0"))+" "+ampm;document.getElementById("set-time-result").textContent="";}
function checkSetTime(){var h=clockH%12===0?12:clockH%12;var ca=clockH<12?"a.m.":"p.m.";var hOk=h===setTimeTgt.h;var mOk=Math.abs(clockM-setTimeTgt.m)<=2;var aOk=ca===setTimeTgt.ampm;var res=document.getElementById("set-time-result");if(hOk&&mOk&&aOk){res.textContent="ğŸ‰ Correct! +3 â­";res.style.color="#2e7d32";awardStar(3);spawnConfetti(25);setTimeout(newSetTimeTgt,2000);}else{res.textContent="âŒ Not quite! Check the hour, minutes, and a.m./p.m.!";res.style.color="#c62828";}}

// CLOCK QUIZ
var cqTimes=[{h:3,m:0},{h:6,m:0},{h:9,m:0},{h:1,m:30},{h:5,m:0},{h:8,m:15},{h:11,m:0},{h:2,m:0},{h:7,m:0},{h:4,m:45},{h:10,m:30},{h:12,m:0}];
function renderCQNumbers(){var g=document.getElementById("cq-numbers");if(!g)return;g.innerHTML="";for(var i=1;i<=12;i++){var a=(i/12)*Math.PI*2-Math.PI/2;var t=document.createElementNS("http://www.w3.org/2000/svg","text");t.setAttribute("x",120+Math.cos(a)*80);t.setAttribute("y",120+Math.sin(a)*80);t.setAttribute("text-anchor","middle");t.setAttribute("dominant-baseline","middle");t.setAttribute("font-family","Baloo 2");t.setAttribute("font-weight","700");t.setAttribute("font-size","15");t.setAttribute("fill","#5c35a0");t.textContent=i;g.appendChild(t);}}
function renderClockQuiz(){var t=cqTimes[cqIdx%cqTimes.length];setHand("cq-hour",((t.h%12)+t.m/60)/12*360,52);setHand("cq-minute",t.m/60*360,72);var correct=(t.h===12||t.h===0?12:t.h%12)+":"+(t.m.toString().padStart(2,"0"));var opts=[correct];while(opts.length<4){var fh=Math.floor(Math.random()*12)+1;var fm=[0,15,30,45][Math.floor(Math.random()*4)];var o=fh+":"+(fm.toString().padStart(2,"0"));if(!opts.includes(o))opts.push(o);}opts.sort(function(){return Math.random()-.5;});var wrap=document.getElementById("cq-options");wrap.innerHTML="";document.getElementById("cq-feedback").textContent="";opts.forEach(function(o){var b=document.createElement("button");b.className="qopt";b.textContent=o;b.onclick=function(){wrap.querySelectorAll(".qopt").forEach(function(x){x.disabled=true;if(x.textContent===correct)x.classList.add("correct");});if(o===correct){b.classList.add("correct");document.getElementById("cq-feedback").innerHTML="<span class='fb-ok'>ğŸ‰ Correct! +2 â­</span>";awardStar(2);spawnConfetti(15);}else{b.classList.add("wrong");document.getElementById("cq-feedback").innerHTML="<span class='fb-bad'>âŒ Answer: "+correct+"</span>";}setTimeout(function(){cqIdx++;renderClockQuiz();},2000);};wrap.appendChild(b);});}

// CALENDAR
function renderCalendar(){
  var dnames=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];
  var fullD=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];
  var firstDay=0,dim=28;
  var grid=document.getElementById("cal-grid");grid.innerHTML="";
  dnames.forEach(function(d){var h=document.createElement("div");h.className="cal-h";h.textContent=d;grid.appendChild(h);});
  for(var i=0;i<firstDay;i++){var e=document.createElement("div");e.className="cal-day empty";grid.appendChild(e);}
  for(var d=1;d<=dim;d++){
    var cell=document.createElement("div");var dow=(firstDay+d-1)%7;
    cell.className="cal-day"+(d===18?" today":"")+(daysVisited.has(d)?" visited":"");cell.textContent=d;
    (function(dd,cell,dow){cell.onclick=function(){daysVisited.add(dd);cell.className="cal-day visited"+(dd===18?" today":"");showToast("ğŸ“… "+fullD[dow]+", February "+dd+", 2026");saveState();};})(d,cell,dow);
    grid.appendChild(cell);
  }
  document.getElementById("today-label").textContent="Wednesday, February 18, 2026";
  buildDayOrder();buildMonths();buildPoem();
}
// DAYS DRAG
var DAYS_ORDER=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];
function buildDayOrder(){
  var src=document.getElementById("day-source"),tgt=document.getElementById("day-targets");if(!src||!tgt)return;
  var shuffled=DAYS_ORDER.slice().sort(function(){return Math.random()-.5;});dayOrderState=Array(7).fill(null);src.innerHTML="";tgt.innerHTML="";
  shuffled.forEach(function(day){var el=document.createElement("div");el.className="draggable-day";el.textContent=day;el.draggable=true;el.addEventListener("dragstart",function(e){e.dataTransfer.setData("text",day);el.classList.add("dragging");});el.addEventListener("dragend",function(){el.classList.remove("dragging");});src.appendChild(el);});
  for(var i=0;i<7;i++){
    (function(idx){var tg=document.createElement("div");tg.className="drop-tgt";tg.textContent=(idx+1)+".";tg.addEventListener("dragover",function(e){e.preventDefault();tg.classList.add("over");});tg.addEventListener("dragleave",function(){tg.classList.remove("over");});tg.addEventListener("drop",function(e){e.preventDefault();tg.classList.remove("over");var day=e.dataTransfer.getData("text");tg.textContent=day;dayOrderState[idx]=day;Array.from(src.querySelectorAll(".draggable-day")).forEach(function(x){if(x.textContent===day)x.remove();});});tgt.appendChild(tg);})(i);
  }
  document.getElementById("day-order-result").textContent="";
}
function checkDayOrder(){var correct=0;document.querySelectorAll("#day-targets .drop-tgt").forEach(function(tg,i){if(dayOrderState[i]===DAYS_ORDER[i]){tg.classList.add("correct");correct++;}else if(dayOrderState[i]){tg.classList.add("wrong");}});var res=document.getElementById("day-order-result");if(correct===7){res.textContent="ğŸ‰ Perfect! All 7 days correct!";res.style.color="#2e7d32";awardStar(5);if(!unlockedBadges.includes("days_order")){unlockedBadges.push("days_order");showToast("ğŸ“† Badge: Week Wizard!");checkBadges();}}else{res.textContent="You got "+correct+"/7 right! Try again!";res.style.color="#c62828";}}

// MONTHS
var MONTH_DATA=[
  {name:"January",days:31,bg:"linear-gradient(135deg,#B3E5FC,#0288D1)",icon:"â„ï¸"},
  {name:"February",days:"28/29",bg:"linear-gradient(135deg,#F8BBD0,#E91E63)",icon:"ğŸ’•"},
  {name:"March",days:31,bg:"linear-gradient(135deg,#C8E6C9,#388E3C)",icon:"ğŸŒ±"},
  {name:"April",days:30,bg:"linear-gradient(135deg,#DCEDC8,#7CB342)",icon:"ğŸŒ¸"},
  {name:"May",days:31,bg:"linear-gradient(135deg,#FFE082,#F9A825)",icon:"ğŸŒ»"},
  {name:"June",days:30,bg:"linear-gradient(135deg,#FFCDD2,#E53935)",icon:"ğŸŒ"},
  {name:"July",days:31,bg:"linear-gradient(135deg,#FF8A65,#D84315)",icon:"ğŸ–ï¸"},
  {name:"August",days:31,bg:"linear-gradient(135deg,#A5D6A7,#2E7D32)",icon:"ğŸ’"},
  {name:"September",days:30,bg:"linear-gradient(135deg,#FFCC80,#EF6C00)",icon:"ğŸ‚"},
  {name:"October",days:31,bg:"linear-gradient(135deg,#FF8A65,#BF360C)",icon:"ğŸƒ"},
  {name:"November",days:30,bg:"linear-gradient(135deg,#CE93D8,#6A1B9A)",icon:"ğŸª”"},
  {name:"December",days:31,bg:"linear-gradient(135deg,#B3E5FC,#0D47A1)",icon:"ğŸ„"},
];
function buildMonths(){var mg=document.getElementById("months-grid");if(!mg)return;mg.innerHTML="";MONTH_DATA.forEach(function(m,i){var chip=document.createElement("div");chip.className="month-chip"+(monthsVisited.has(i)?" picked":"");chip.style.background=m.bg;chip.innerHTML="<div>"+m.icon+" <strong>"+m.name+"</strong></div><div class='m-days'>"+m.days+" days</div>";chip.onclick=function(){monthsVisited.add(i);chip.classList.add("picked");document.getElementById("month-info-box").innerHTML="<div style='animation:popIn .35s cubic-bezier(.36,1.56,.64,1) both'>"+m.icon+" <strong>"+m.name+"</strong> has <strong>"+m.days+" days</strong>!</div>";saveState();checkBadges();};mg.appendChild(chip);});}

// POEM
var POEM_LINES=["Thirty days have September,","April, June and November,","All the rest have thirty-one,","Except February alone,","Which has only twenty-eight days,","And twenty-nine in each leap year."];
function buildPoem(){var pl=document.getElementById("poem-lines");if(!pl)return;pl.innerHTML="";POEM_LINES.forEach(function(line,i){var el=document.createElement("div");el.className="poem-line";el.textContent=line;el.onclick=function(){document.querySelectorAll(".poem-line").forEach(function(x){x.classList.remove("lit");});el.classList.add("lit");showToast("ğŸµ "+line);};pl.appendChild(el);});}

// COMPASS
var compassAngle=0,isDragCompass=false,compStartA=0,compStartRot=0;
var compOuter=document.getElementById("compass-outer");
var compInner=document.getElementById("compass-inner");
function startCompassDrag(e){isDragCompass=true;var pos=e.touches?e.touches[0]:e;var rect=compOuter.getBoundingClientRect();compStartA=Math.atan2(pos.clientY-(rect.top+rect.height/2),pos.clientX-(rect.left+rect.width/2));compStartRot=compassAngle;e.preventDefault();}
compOuter.addEventListener("mousedown",startCompassDrag);
compOuter.addEventListener("touchstart",startCompassDrag,{passive:false});
document.addEventListener("mousemove",function(e){if(!isDragCompass)return;var rect=compOuter.getBoundingClientRect();var a=Math.atan2(e.clientY-(rect.top+rect.height/2),e.clientX-(rect.left+rect.width/2));compassAngle=compStartRot+(a-compStartA)*180/Math.PI;compOuter.style.transform="rotate("+compassAngle+"deg)";compInner.style.transform="rotate("+(-compassAngle)+"deg)";});
document.addEventListener("touchmove",function(e){if(!isDragCompass)return;e.preventDefault();var touch=e.touches[0];var rect=compOuter.getBoundingClientRect();var a=Math.atan2(touch.clientY-(rect.top+rect.height/2),touch.clientX-(rect.left+rect.width/2));compassAngle=compStartRot+(a-compStartA)*180/Math.PI;compOuter.style.transform="rotate("+compassAngle+"deg)";compInner.style.transform="rotate("+(-compassAngle)+"deg)";},{passive:false});
document.addEventListener("mouseup",function(){isDragCompass=false;});
document.addEventListener("touchend",function(){isDragCompass=false;});
function showDirInfo(dir,desc){dirExplored.add(dir);checkBadges();showModalMsg({North:"â¬†ï¸",South:"â¬‡ï¸",East:"â¡ï¸",West:"â¬…ï¸"}[dir]||"ğŸ§­",dir,desc);}

// POSITION WORDS
var positions={left:{left:"8%",top:"45%"},right:{left:"70%",top:"45%"},up:{left:"40%",top:"8%"},down:{left:"40%",top:"65%"},near:{left:"60%",top:"18%"},far:{left:"8%",top:"50%"},front:{left:"28%",top:"55%"},behind:{left:"12%",top:"55%"},above:{left:"40%",top:"3%"},below:{left:"40%",top:"68%"},reset:{left:"42%",top:"38%"}};
var posLabels={left:"ğŸ‘§ is to the LEFT ğŸ‘ˆ",right:"ğŸ‘§ is to the RIGHT ğŸ‘‰",up:"ğŸ‘§ is UP! â¬†ï¸",down:"ğŸ‘§ is DOWN â¬‡ï¸",near:"ğŸ‘§ is NEAR the tree ğŸŒ³",far:"ğŸ‘§ is FAR from the tree ğŸ“",front:"ğŸ‘§ is in FRONT of the boy ğŸš¶",behind:"ğŸ‘§ is BEHIND the boy ğŸ”™",above:"ğŸ‘§ is ABOVE â¬†",below:"ğŸ‘§ is BELOW â¬‡",reset:"Back to start! ğŸ”„"};
function moveGirl(dir){var girl=document.getElementById("pos-girl");var p=positions[dir]||positions.reset;girl.style.left=p.left;girl.style.top=p.top;document.getElementById("pos-label").textContent=posLabels[dir]||"";spawnConfetti(4);}

// MAZE
function initMaze(){
  var canvas=document.getElementById("maze-canvas");if(!canvas)return;
  canvas.width=MAZE_COLS*CELL;canvas.height=MAZE_ROWS*CELL;
  mazeGrid=[];
  for(var y=0;y<MAZE_ROWS;y++){mazeGrid.push([]);for(var x=0;x<MAZE_COLS;x++){mazeGrid[y].push({r:true,b:true});}}
  var openW=[[0,0,"r"],[1,0,"b"],[1,0,"r"],[2,0,"r"],[3,0,"r"],[4,0,"r"],[5,0,"r"],[6,0,"b"],[0,1,"r"],[0,1,"b"],[1,1,"r"],[2,1,"r"],[2,1,"b"],[3,1,"b"],[4,1,"r"],[5,1,"b"],[6,1,"r"],[0,2,"b"],[1,2,"r"],[1,2,"b"],[2,2,"r"],[3,2,"r"],[4,2,"b"],[5,2,"r"],[6,2,"b"],[0,3,"r"],[1,3,"r"],[2,3,"b"],[3,3,"r"],[4,3,"r"],[5,3,"r"],[6,3,"b"],[0,4,"r"],[0,4,"b"],[1,4,"b"],[2,4,"r"],[3,4,"r"],[4,4,"r"],[5,4,"b"],[6,4,"r"],[0,5,"r"],[1,5,"r"],[2,5,"r"],[3,5,"r"],[4,5,"r"],[5,5,"r"],[6,5,"r"]];
  openW.forEach(function(w){if(mazeGrid[w[1]]&&mazeGrid[w[1]][w[0]])mazeGrid[w[1]][w[0]][w[2]]=false;});
  playerX=0;playerY=0;mazeWon=false;document.getElementById("maze-result").textContent="";drawMaze();
  document.onkeydown=function(e){if(["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(e.key)){e.preventDefault();var map={ArrowUp:[0,-1],ArrowDown:[0,1],ArrowLeft:[-1,0],ArrowRight:[1,0]};var d=map[e.key];mazeMovePlayer(d[0],d[1]);}};
}
function canMove(x,y,dx,dy){if(dx===1)return x<MAZE_COLS-1&&!mazeGrid[y][x].r;if(dy===1)return y<MAZE_ROWS-1&&!mazeGrid[y][x].b;if(dx===-1)return x>0&&!mazeGrid[y][x-1].r;if(dy===-1)return y>0&&!mazeGrid[y-1][x].b;return false;}
function mazeMovePlayer(dx,dy){if(mazeWon)return;if(canMove(playerX,playerY,dx,dy)){playerX+=dx;playerY+=dy;spawnConfetti(3);drawMaze();if(playerX===MAZE_COLS-1&&playerY===MAZE_ROWS-1){mazeWon=true;document.getElementById("maze-result").textContent="ğŸ‰ You found the way home! Amazing!";awardStar(5);spawnConfetti(30);if(!unlockedBadges.includes("maze_win")){unlockedBadges.push("maze_win");showToast("ğŸ—ºï¸ Badge: Pathfinder!");checkBadges();}}}else{var canvas=document.getElementById("maze-canvas");canvas.style.transform="translateX(4px)";setTimeout(function(){canvas.style.transform="translateX(-4px)";setTimeout(function(){canvas.style.transform="";},100);},100);}}
function resetMaze(){initMaze();}
function drawMaze(){var canvas=document.getElementById("maze-canvas");if(!canvas)return;var ctx=canvas.getContext("2d");ctx.clearRect(0,0,canvas.width,canvas.height);ctx.fillStyle="#f3e8ff";ctx.fillRect(0,0,canvas.width,canvas.height);ctx.fillStyle="#C8E6C9";ctx.fillRect((MAZE_COLS-1)*CELL,(MAZE_ROWS-1)*CELL,CELL,CELL);ctx.font="26px serif";ctx.textAlign="center";ctx.textBaseline="middle";ctx.fillText("ğŸ ",(MAZE_COLS-1)*CELL+CELL/2,(MAZE_ROWS-1)*CELL+CELL/2);ctx.fillText("ğŸ§’",playerX*CELL+CELL/2,playerY*CELL+CELL/2);ctx.strokeStyle="#5c35a0";ctx.lineWidth=3;ctx.lineCap="round";ctx.strokeRect(0,0,canvas.width,canvas.height);for(var y=0;y<MAZE_ROWS;y++){for(var x=0;x<MAZE_COLS;x++){var cx=x*CELL,cy=y*CELL;if(mazeGrid[y][x].r&&x<MAZE_COLS-1){ctx.beginPath();ctx.moveTo(cx+CELL,cy);ctx.lineTo(cx+CELL,cy+CELL);ctx.stroke();}if(mazeGrid[y][x].b&&y<MAZE_ROWS-1){ctx.beginPath();ctx.moveTo(cx,cy+CELL);ctx.lineTo(cx+CELL,cy+CELL);ctx.stroke();}}}ctx.fillStyle="#9C6FDE";ctx.font="bold 11px Nunito";ctx.textAlign="left";ctx.fillText("START",4,14);}

// QUIZ
var QUESTIONS=[
  {q:"What time of day does the Sun rise?",opts:["Morning","Evening","Midnight","Noon"],ans:"Morning",icon:"ğŸŒ…"},
  {q:"How many hours are there in one day?",opts:["12","48","24","7"],ans:"24",icon:"â°"},
  {q:"12 o'clock at night is called...?",opts:["Noon","Midnight","Evening","Dusk"],ans:"Midnight",icon:"ğŸŒ™"},
  {q:"Time between midnight and noon uses...?",opts:["p.m.","a.m.","noon","PM"],ans:"a.m.",icon:"â˜€ï¸"},
  {q:"How many days are in a week?",opts:["5","6","7","8"],ans:"7",icon:"ğŸ“…"},
  {q:"How many months in a year?",opts:["10","11","12","13"],ans:"12",icon:"ğŸ—“ï¸"},
  {q:"The Sun sets in which direction?",opts:["North","East","South","West"],ans:"West",icon:"ğŸŒ‡"},
  {q:"When facing East, what is behind you?",opts:["North","South","East","West"],ans:"West",icon:"ğŸ§­"},
  {q:"February normally has how many days?",opts:["30","31","28","29"],ans:"28",icon:"ğŸ“†"},
  {q:"A year with 366 days is a...?",opts:["Big year","Leap year","Long year","Bonus year"],ans:"Leap year",icon:"ğŸ¸"},
  {q:"How many seconds are in a minute?",opts:["100","50","30","60"],ans:"60",icon:"â±ï¸"},
  {q:"Which day comes after Wednesday?",opts:["Tuesday","Monday","Thursday","Friday"],ans:"Thursday",icon:"ğŸ“…"},
  {q:"Facing East, right hand points to...?",opts:["North","West","East","South"],ans:"South",icon:"ğŸ§­"},
  {q:"A compass always points towards...?",opts:["South","East","North","West"],ans:"North",icon:"ğŸ§²"},
  {q:"How many minutes in one hour?",opts:["100","60","30","24"],ans:"60",icon:"ğŸ•"},
  {q:"Which month has 30 days?",opts:["January","March","April","July"],ans:"April",icon:"ğŸŒ¸"},
  {q:"What tells us the exact time?",opts:["Calendar","Compass","Clock","Map"],ans:"Clock",icon:"ğŸ•"},
  {q:"The Sun rises in which direction?",opts:["North","South","West","East"],ans:"East",icon:"ğŸŒ…"},
  {q:"How many days in a normal year?",opts:["364","365","366","360"],ans:"365",icon:"ğŸ“†"},
  {q:"Which is the last month of the year?",opts:["November","October","January","December"],ans:"December",icon:"ğŸ„"},
  {q:"The short hand on a clock shows...?",opts:["Seconds","Minutes","Hours","Days"],ans:"Hours",icon:"ğŸ•"},
  {q:"Which day is between Monday and Wednesday?",opts:["Sunday","Tuesday","Thursday","Friday"],ans:"Tuesday",icon:"ğŸ“…"},
];
function initQuiz(){shuffledQ=QUESTIONS.slice().sort(function(){return Math.random()-.5;});quizIndex=0;quizScore=0;quizAnswered=false;renderQuizProg();showQuestion();}
function renderQuizProg(){var p=document.getElementById("quiz-progress");p.innerHTML="";shuffledQ.forEach(function(_,i){var d=document.createElement("div");d.className="q-dot"+(i<quizIndex?" done":i===quizIndex?" curr":"");p.appendChild(d);});}
function showQuestion(){if(quizIndex>=shuffledQ.length){showQuizEnd();return;}var q=shuffledQ[quizIndex];document.getElementById("quiz-q").textContent=q.icon+" "+q.q;var opts=document.getElementById("quiz-opts");opts.innerHTML="";document.getElementById("quiz-feedback").textContent="";document.getElementById("next-btn").style.display="none";quizAnswered=false;q.opts.slice().sort(function(){return Math.random()-.5;}).forEach(function(o){var b=document.createElement("button");b.className="qopt";b.textContent=o;b.onclick=function(){answerQ(o,q.ans,b);};opts.appendChild(b);});renderQuizProg();}
function answerQ(chosen,correct,btn){if(quizAnswered)return;quizAnswered=true;document.querySelectorAll(".qopt").forEach(function(b){b.disabled=true;if(b.textContent===correct)b.classList.add("correct");});var fb=document.getElementById("quiz-feedback");if(chosen===correct){btn.classList.add("correct");fb.innerHTML="<span class='fb-ok'>ğŸ‰ Correct! +2 â­</span>";quizScore++;awardStar(2);spawnConfetti(16);}else{btn.classList.add("wrong");fb.innerHTML="<span class='fb-bad'>âŒ The answer is: "+correct+"</span>";}document.getElementById("next-btn").style.display="block";}
function nextQuestion(){quizIndex++;if(quizIndex>=shuffledQ.length){showQuizEnd();return;}showQuestion();}
function showQuizEnd(){document.getElementById("quiz-q").textContent="ğŸŠ Quiz Complete!";document.getElementById("quiz-opts").innerHTML="";var pct=Math.round(quizScore/shuffledQ.length*100);var emoji=pct===100?"ğŸ’":pct>=80?"ğŸ†":pct>=60?"ğŸŒŸ":"ğŸ˜Š";document.getElementById("quiz-feedback").innerHTML="<span class='fb-ok'>"+emoji+" You got "+quizScore+"/"+shuffledQ.length+" correct! ("+pct+"%)</span>";document.getElementById("next-btn").style.display="none";spawnConfetti(35);if(!unlockedBadges.includes("quiz_all")){unlockedBadges.push("quiz_all");showToast("ğŸ… Badge: Quiz Champion!");}if(pct===100&&!unlockedBadges.includes("perfect")){unlockedBadges.push("perfect");showToast("ğŸ’ Badge: Perfect Score!");}checkBadges();saveState();if(pct>=80)setTimeout(function(){showModalMsg(emoji,"Quiz Complete!","You scored "+quizScore+"/"+shuffledQ.length+"! You are a superstar! ğŸŒŸ");},800);}

// INIT
(function(){
  document.getElementById("star-display").textContent=stars;
  document.getElementById("star-display-2").textContent=stars;
  document.getElementById("badge-count").textContent=unlockedBadges.length;
  buildUnitChain();renderClockNumbers();renderCQNumbers();renderCalendar();renderBadges();initQuiz();initMaze();
  setTimeout(function(){showToast("ğŸ¦‰ Hello! Drag the sun across the sky to begin! â˜€ï¸");},1200);
})();
</script>
</body>
</html>